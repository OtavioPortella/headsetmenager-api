generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Perfil {
  id               Int     @id @default(autoincrement())
  nome             String
  user             User[]
  podeCriarUsuario Boolean @default(false)
  admin            Boolean
}

model Pedido {
  id         Int      @id @default(autoincrement())
  usuario    User     @relation(fields: [idUsuario], references: [id])
  idUsuario  Int
  qtdSimples Int
  matriculas String[]

  createdAt DateTime @default(now())
}

model User {
  id         Int       @id @default(autoincrement())
  nome       String
  matricula  String    @unique
  perfil     Perfil    @relation(fields: [idPerfil], references: [id])
  idPerfil   Int
  pedido     Pedido[]
  carteira   Carteira? @relation(fields: [idCarteira], references: [id])
  idCarteira Int?
  senha      String
}

model Carteira {
  id       Int     @id @default(autoincrement())
  nome     String
  filial   Filial? @relation(fields: [idFilial], references: [id])
  idFilial Int?
  usuarios User[]
}

model Filial {
  id            Int        @id @default(autoincrement())
  nome          String
  carteiras     Carteira[]
  estoque       Estoque[]
  endereco      Endereco   @relation(fields: [idEndereco], references: [id])
  idEndereco    Int
  maloteOrigem  Malote[]   @relation("filial_origem_malote")
  maloteDestino Malote[]   @relation("filial_destino_malote")
}

model Estoque {
  id         Int    @id @default(autoincrement())
  qtdSimples Int
  qtdDuplo   Int
  filial     Filial @relation(fields: [idFilial], references: [id])
  idFilial   Int
}

model Endereco {
  id     Int      @id @default(autoincrement())
  rua    String
  numero String
  cep    String
  bairro String
  cidade String
  estado String
  filial Filial[]
}

model Malote {
  id              Int      @id @default(autoincrement())
  qtdSimples      Int
  qtdDuplo        Int
  garantia        Boolean
  filialOrigem    Filial   @relation(fields: [filialOrigemId], references: [id], name: "filial_origem_malote")
  filialDestino   Filial   @relation(fields: [filialDestinoId], references: [id], name: "filial_destino_malote")
  filialOrigemId  Int
  filialDestinoId Int
  createdAt       DateTime @default(now())
}
